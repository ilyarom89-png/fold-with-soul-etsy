<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Fold With Soul • Heart • 19 cm</title>
<style>
  :root {
    --bg:#0b1220;
    --card:#111a2b;
    --muted:#8ea0c0;
    --text:#eaf0ff;
    --accent:#66b2ff;
    --border:rgba(255,255,255,.12);
  }
  body {
    margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    background:linear-gradient(180deg, var(--bg), #060a13);
    color:var(--text);
  }
  .wrap { max-width:1100px; margin:0 auto; padding:18px; }
  .hero {
    background: radial-gradient(1200px 500px at 10% 10%, rgba(102,178,255,.22), transparent 60%),
                radial-gradient(900px 400px at 90% 15%, rgba(140,105,255,.18), transparent 55%),
                var(--card);
    border:1px solid var(--border);
    border-radius:18px;
    padding:18px 18px 14px;
    box-shadow:0 10px 28px rgba(0,0,0,.35);
  }
  h1 { margin:0; font-size:20px; letter-spacing:.2px; }
  .sub { margin:6px 0 0; color:var(--muted); font-size:13px; line-height:1.35; }
  .grid { display:grid; grid-template-columns: 1fr; gap:14px; margin-top:14px; }
  @media (min-width: 920px) {
    .grid { grid-template-columns: 360px 1fr; }
  }
  .card {
    background:rgba(17,26,43,.75);
    border:1px solid var(--border);
    border-radius:16px;
    padding:14px;
  }
  .row { display:flex; gap:10px; flex-wrap:wrap; align-items:flex-end; }
  label { display:block; font-size:12px; color:var(--muted); margin-bottom:6px; }
  input, select {
    width:100%;
    box-sizing:border-box;
    background:#0c1526;
    color:var(--text);
    border:1px solid rgba(255,255,255,.14);
    border-radius:12px;
    padding:10px 12px;
    font-size:14px;
    outline:none;
  }
  input:focus, select:focus { border-color: rgba(102,178,255,.7); box-shadow:0 0 0 3px rgba(102,178,255,.15); }
  .btn {
    appearance:none;
    border:none;
    border-radius:12px;
    padding:10px 12px;
    background:rgba(102,178,255,.18);
    color:var(--text);
    border:1px solid rgba(102,178,255,.35);
    cursor:pointer;
    font-weight:600;
    font-size:14px;
  }
  .btn:hover { filter:brightness(1.05); }
  .btn.secondary {
    background:transparent;
    border:1px solid rgba(255,255,255,.18);
    color:var(--text);
  }
  .kpi {
    display:grid; grid-template-columns: 1fr 1fr;
    gap:10px; margin-top:10px;
  }
  .kpi .box {
    background:#0c1526;
    border:1px solid rgba(255,255,255,.12);
    border-radius:14px;
    padding:10px 12px;
  }
  .kpi .val { font-size:16px; font-weight:750; }
  .kpi .lbl { font-size:12px; color:var(--muted); margin-top:2px; }
  .hint { margin-top:10px; font-size:12px; color:var(--muted); line-height:1.4; }
  .toolbar { display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between; margin-bottom:10px; }
  .toolbar .left { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
  .small { font-size:12px; color:var(--muted); }
  table {
    width:100%;
    border-collapse:separate;
    border-spacing:0;
    overflow:hidden;
    border-radius:14px;
    border:1px solid rgba(255,255,255,.12);
    background:#0c1526;
  }
  th, td {
    padding:10px 10px;
    font-size:13px;
    border-bottom:1px solid rgba(255,255,255,.08);
    vertical-align:top;
    text-align:left;
  }
  th {
    position:sticky; top:0;
    background:rgba(12,21,38,.98);
    z-index:1;
    font-size:12px;
    color:var(--muted);
    text-transform:uppercase;
    letter-spacing:.06em;
  }
  tr:last-child td { border-bottom:none; }
  .mono { font-variant-numeric: tabular-nums; font-feature-settings:"tnum" 1; }
  .pill {
    display:inline-block;
    padding:4px 8px;
    border-radius:999px;
    border:1px solid rgba(255,255,255,.14);
    background:rgba(255,255,255,.06);
    font-size:12px;
    color:var(--muted);
  }
  @media print {
    body { background:#fff; color:#000; }
    .hero, .card, table { box-shadow:none !important; }
    .btn, .toolbar, .hint { display:none !important; }
    .wrap { max-width:none; padding:0; }
    .grid { grid-template-columns: 1fr; }
    th { position:static; }
    table { border:1px solid #000; }
    th, td { border-bottom:1px solid #000; }
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="hero">
      <h1>Fold With Soul Calculator — <span class="mono">Heart</span> <span class="pill">19 cm</span></h1>
      <p class="sub">
        MMF (Measure • Mark • Fold) • No cutting • No glue<br/>
        This file already contains the full fold list for the 19 cm version (180 folds).
      </p>
    </div>

    <div class="grid">
      <div class="card" id="controls">
        <div class="row">
          <div style="flex:1; min-width:200px;">
            <label for="bookPages">My book total pages (optional)</label>
            <input id="bookPages" inputmode="numeric" placeholder="e.g., 398" />
          </div>
          <div style="width:160px;">
            <label for="align">Alignment</label>
            <select id="align">
              <option value="center" selected>Center</option>
              <option value="top">Start near front</option>
              <option value="bottom">Start near end</option>
            </select>
          </div>
        </div>

        <div class="kpi">
          <div class="box">
            <div class="val mono" id="kpiFolds">180</div>
            <div class="lbl">Total folds</div>
          </div>
          <div class="box">
            <div class="val mono" id="kpiPagesNeeded">362</div>
            <div class="lbl">Pages needed (approx.)</div>
          </div>
          <div class="box">
            <div class="val mono" id="kpiStart">—</div>
            <div class="lbl">Start page (odd)</div>
          </div>
          <div class="box">
            <div class="val mono" id="kpiEnd">—</div>
            <div class="lbl">End page</div>
          </div>
        </div>

        <p class="hint">
          We fold on <b>odd pages only</b>: 1, 3, 5...<br/>
          If your book has more pages than needed, the calculator can center the design by choosing a later start page.
        </p>

        <div class="row" style="margin-top:10px;">
          <button class="btn" id="btnApply">Apply</button>
          <button class="btn secondary" id="btnReset">Reset</button>
        </div>
      </div>

      <div class="card">
        <div class="toolbar">
          <div class="left">
            <button class="btn" id="btnPrint">Save as PDF / Print</button>
            <button class="btn secondary" id="btnDownload">Download table (CSV)</button>
          </div>
          <div class="small" id="status">Loaded: 180 folds • Updated: 2025-12-28</div>
        </div>

        <div style="overflow:auto; max-height:70vh; border-radius:14px;">
          <table id="tbl">
            <thead>
              <tr>
                <th>Fold</th>
                <th>Page (odd)</th>
                <th>Mark 1 (cm)</th>
                <th>Mark 2 (cm)</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <p class="hint">
          Tip: When printing to PDF, set margins to <b>Default</b> (or <b>None</b>) and enable background graphics if your browser has that option.
        </p>
      </div>
    </div>
  </div>

<script>
const patternName = "Heart";
const bookHeightCm = 19;
const foldsData = [{"Fold": 1, "Mark1": 5.6, "Mark2": 6.4}, {"Fold": 2, "Mark1": 5.1, "Mark2": 6.9}, {"Fold": 3, "Mark1": 4.9, "Mark2": 7.2}, {"Fold": 4, "Mark1": 4.7, "Mark2": 7.4}, {"Fold": 5, "Mark1": 4.6, "Mark2": 7.6}, {"Fold": 6, "Mark1": 4.4, "Mark2": 7.8}, {"Fold": 7, "Mark1": 4.3, "Mark2": 8.0}, {"Fold": 8, "Mark1": 4.2, "Mark2": 8.1}, {"Fold": 9, "Mark1": 4.1, "Mark2": 8.3}, {"Fold": 10, "Mark1": 4.0, "Mark2": 8.4}, {"Fold": 11, "Mark1": 3.9, "Mark2": 8.5}, {"Fold": 12, "Mark1": 3.9, "Mark2": 8.6}, {"Fold": 13, "Mark1": 3.8, "Mark2": 8.8}, {"Fold": 14, "Mark1": 3.7, "Mark2": 8.9}, {"Fold": 15, "Mark1": 3.6, "Mark2": 9.0}, {"Fold": 16, "Mark1": 3.6, "Mark2": 9.1}, {"Fold": 17, "Mark1": 3.5, "Mark2": 9.2}, {"Fold": 18, "Mark1": 3.5, "Mark2": 9.3}, {"Fold": 19, "Mark1": 3.4, "Mark2": 9.4}, {"Fold": 20, "Mark1": 3.4, "Mark2": 9.5}, {"Fold": 21, "Mark1": 3.3, "Mark2": 9.6}, {"Fold": 22, "Mark1": 3.3, "Mark2": 9.7}, {"Fold": 23, "Mark1": 3.2, "Mark2": 9.8}, {"Fold": 24, "Mark1": 3.2, "Mark2": 9.9}, {"Fold": 25, "Mark1": 3.1, "Mark2": 10.0}, {"Fold": 26, "Mark1": 3.1, "Mark2": 10.1}, {"Fold": 27, "Mark1": 3.1, "Mark2": 10.2}, {"Fold": 28, "Mark1": 3.0, "Mark2": 10.3}, {"Fold": 29, "Mark1": 3.0, "Mark2": 10.4}, {"Fold": 30, "Mark1": 3.0, "Mark2": 10.4}, {"Fold": 31, "Mark1": 2.9, "Mark2": 10.5}, {"Fold": 32, "Mark1": 2.9, "Mark2": 10.6}, {"Fold": 33, "Mark1": 2.9, "Mark2": 10.7}, {"Fold": 34, "Mark1": 2.9, "Mark2": 10.8}, {"Fold": 35, "Mark1": 2.9, "Mark2": 10.9}, {"Fold": 36, "Mark1": 2.8, "Mark2": 10.9}, {"Fold": 37, "Mark1": 2.8, "Mark2": 11.0}, {"Fold": 38, "Mark1": 2.8, "Mark2": 11.1}, {"Fold": 39, "Mark1": 2.8, "Mark2": 11.2}, {"Fold": 40, "Mark1": 2.8, "Mark2": 11.3}, {"Fold": 41, "Mark1": 2.8, "Mark2": 11.4}, {"Fold": 42, "Mark1": 2.8, "Mark2": 11.5}, {"Fold": 43, "Mark1": 2.8, "Mark2": 11.5}, {"Fold": 44, "Mark1": 2.8, "Mark2": 11.6}, {"Fold": 45, "Mark1": 2.7, "Mark2": 11.7}, {"Fold": 46, "Mark1": 2.7, "Mark2": 11.8}, {"Fold": 47, "Mark1": 2.7, "Mark2": 11.9}, {"Fold": 48, "Mark1": 2.7, "Mark2": 11.9}, {"Fold": 49, "Mark1": 2.7, "Mark2": 12.0}, {"Fold": 50, "Mark1": 2.7, "Mark2": 12.1}, {"Fold": 51, "Mark1": 2.7, "Mark2": 12.2}, {"Fold": 52, "Mark1": 2.8, "Mark2": 12.3}, {"Fold": 53, "Mark1": 2.8, "Mark2": 12.4}, {"Fold": 54, "Mark1": 2.8, "Mark2": 12.5}, {"Fold": 55, "Mark1": 2.8, "Mark2": 12.5}, {"Fold": 56, "Mark1": 2.8, "Mark2": 12.6}, {"Fold": 57, "Mark1": 2.8, "Mark2": 12.7}, {"Fold": 58, "Mark1": 2.8, "Mark2": 12.8}, {"Fold": 59, "Mark1": 2.8, "Mark2": 12.9}, {"Fold": 60, "Mark1": 2.8, "Mark2": 13.0}, {"Fold": 61, "Mark1": 2.9, "Mark2": 13.1}, {"Fold": 62, "Mark1": 2.9, "Mark2": 13.2}, {"Fold": 63, "Mark1": 2.9, "Mark2": 13.3}, {"Fold": 64, "Mark1": 2.9, "Mark2": 13.4}, {"Fold": 65, "Mark1": 3.0, "Mark2": 13.4}, {"Fold": 66, "Mark1": 3.0, "Mark2": 13.5}, {"Fold": 67, "Mark1": 3.0, "Mark2": 13.7}, {"Fold": 68, "Mark1": 3.1, "Mark2": 13.7}, {"Fold": 69, "Mark1": 3.1, "Mark2": 13.8}, {"Fold": 70, "Mark1": 3.1, "Mark2": 13.9}, {"Fold": 71, "Mark1": 3.2, "Mark2": 14.0}, {"Fold": 72, "Mark1": 3.2, "Mark2": 14.1}, {"Fold": 73, "Mark1": 3.3, "Mark2": 14.2}, {"Fold": 74, "Mark1": 3.3, "Mark2": 14.3}, {"Fold": 75, "Mark1": 3.4, "Mark2": 14.4}, {"Fold": 76, "Mark1": 3.4, "Mark2": 14.6}, {"Fold": 77, "Mark1": 3.5, "Mark2": 14.6}, {"Fold": 78, "Mark1": 3.6, "Mark2": 14.8}, {"Fold": 79, "Mark1": 3.6, "Mark2": 14.9}, {"Fold": 80, "Mark1": 3.7, "Mark2": 15.0}, {"Fold": 81, "Mark1": 3.8, "Mark2": 15.1}, {"Fold": 82, "Mark1": 3.9, "Mark2": 15.2}, {"Fold": 83, "Mark1": 4.0, "Mark2": 15.4}, {"Fold": 84, "Mark1": 4.1, "Mark2": 15.5}, {"Fold": 85, "Mark1": 4.2, "Mark2": 15.6}, {"Fold": 86, "Mark1": 4.3, "Mark2": 15.8}, {"Fold": 87, "Mark1": 4.4, "Mark2": 15.9}, {"Fold": 88, "Mark1": 4.6, "Mark2": 16.1}, {"Fold": 89, "Mark1": 4.7, "Mark2": 16.2}, {"Fold": 90, "Mark1": 4.8, "Mark2": 16.3}, {"Fold": 91, "Mark1": 4.8, "Mark2": 16.3}, {"Fold": 92, "Mark1": 4.7, "Mark2": 16.2}, {"Fold": 93, "Mark1": 4.6, "Mark2": 16.1}, {"Fold": 94, "Mark1": 4.4, "Mark2": 15.9}, {"Fold": 95, "Mark1": 4.3, "Mark2": 15.8}, {"Fold": 96, "Mark1": 4.2, "Mark2": 15.6}, {"Fold": 97, "Mark1": 4.1, "Mark2": 15.5}, {"Fold": 98, "Mark1": 4.0, "Mark2": 15.4}, {"Fold": 99, "Mark1": 3.9, "Mark2": 15.2}, {"Fold": 100, "Mark1": 3.8, "Mark2": 15.1}, {"Fold": 101, "Mark1": 3.7, "Mark2": 15.0}, {"Fold": 102, "Mark1": 3.6, "Mark2": 14.9}, {"Fold": 103, "Mark1": 3.6, "Mark2": 14.8}, {"Fold": 104, "Mark1": 3.5, "Mark2": 14.6}, {"Fold": 105, "Mark1": 3.4, "Mark2": 14.6}, {"Fold": 106, "Mark1": 3.4, "Mark2": 14.4}, {"Fold": 107, "Mark1": 3.3, "Mark2": 14.3}, {"Fold": 108, "Mark1": 3.3, "Mark2": 14.2}, {"Fold": 109, "Mark1": 3.2, "Mark2": 14.1}, {"Fold": 110, "Mark1": 3.2, "Mark2": 14.0}, {"Fold": 111, "Mark1": 3.1, "Mark2": 13.9}, {"Fold": 112, "Mark1": 3.1, "Mark2": 13.8}, {"Fold": 113, "Mark1": 3.1, "Mark2": 13.7}, {"Fold": 114, "Mark1": 3.0, "Mark2": 13.7}, {"Fold": 115, "Mark1": 3.0, "Mark2": 13.5}, {"Fold": 116, "Mark1": 3.0, "Mark2": 13.4}, {"Fold": 117, "Mark1": 2.9, "Mark2": 13.4}, {"Fold": 118, "Mark1": 2.9, "Mark2": 13.3}, {"Fold": 119, "Mark1": 2.9, "Mark2": 13.2}, {"Fold": 120, "Mark1": 2.9, "Mark2": 13.1}, {"Fold": 121, "Mark1": 2.8, "Mark2": 13.0}, {"Fold": 122, "Mark1": 2.8, "Mark2": 12.9}, {"Fold": 123, "Mark1": 2.8, "Mark2": 12.8}, {"Fold": 124, "Mark1": 2.8, "Mark2": 12.7}, {"Fold": 125, "Mark1": 2.8, "Mark2": 12.6}, {"Fold": 126, "Mark1": 2.8, "Mark2": 12.5}, {"Fold": 127, "Mark1": 2.8, "Mark2": 12.5}, {"Fold": 128, "Mark1": 2.8, "Mark2": 12.4}, {"Fold": 129, "Mark1": 2.8, "Mark2": 12.3}, {"Fold": 130, "Mark1": 2.7, "Mark2": 12.2}, {"Fold": 131, "Mark1": 2.7, "Mark2": 12.1}, {"Fold": 132, "Mark1": 2.7, "Mark2": 12.0}, {"Fold": 133, "Mark1": 2.7, "Mark2": 11.9}, {"Fold": 134, "Mark1": 2.7, "Mark2": 11.9}, {"Fold": 135, "Mark1": 2.7, "Mark2": 11.8}, {"Fold": 136, "Mark1": 2.7, "Mark2": 11.7}, {"Fold": 137, "Mark1": 2.8, "Mark2": 11.6}, {"Fold": 138, "Mark1": 2.8, "Mark2": 11.5}, {"Fold": 139, "Mark1": 2.8, "Mark2": 11.5}, {"Fold": 140, "Mark1": 2.8, "Mark2": 11.4}, {"Fold": 141, "Mark1": 2.8, "Mark2": 11.3}, {"Fold": 142, "Mark1": 2.8, "Mark2": 11.2}, {"Fold": 143, "Mark1": 2.8, "Mark2": 11.1}, {"Fold": 144, "Mark1": 2.8, "Mark2": 11.0}, {"Fold": 145, "Mark1": 2.8, "Mark2": 10.9}, {"Fold": 146, "Mark1": 2.9, "Mark2": 10.9}, {"Fold": 147, "Mark1": 2.9, "Mark2": 10.8}, {"Fold": 148, "Mark1": 2.9, "Mark2": 10.7}, {"Fold": 149, "Mark1": 2.9, "Mark2": 10.6}, {"Fold": 150, "Mark1": 2.9, "Mark2": 10.5}, {"Fold": 151, "Mark1": 3.0, "Mark2": 10.4}, {"Fold": 152, "Mark1": 3.0, "Mark2": 10.4}, {"Fold": 153, "Mark1": 3.0, "Mark2": 10.3}, {"Fold": 154, "Mark1": 3.1, "Mark2": 10.2}, {"Fold": 155, "Mark1": 3.1, "Mark2": 10.1}, {"Fold": 156, "Mark1": 3.1, "Mark2": 10.0}, {"Fold": 157, "Mark1": 3.2, "Mark2": 9.9}, {"Fold": 158, "Mark1": 3.2, "Mark2": 9.8}, {"Fold": 159, "Mark1": 3.3, "Mark2": 9.7}, {"Fold": 160, "Mark1": 3.3, "Mark2": 9.6}, {"Fold": 161, "Mark1": 3.4, "Mark2": 9.5}, {"Fold": 162, "Mark1": 3.4, "Mark2": 9.4}, {"Fold": 163, "Mark1": 3.5, "Mark2": 9.3}, {"Fold": 164, "Mark1": 3.5, "Mark2": 9.2}, {"Fold": 165, "Mark1": 3.6, "Mark2": 9.1}, {"Fold": 166, "Mark1": 3.6, "Mark2": 9.0}, {"Fold": 167, "Mark1": 3.7, "Mark2": 8.9}, {"Fold": 168, "Mark1": 3.8, "Mark2": 8.8}, {"Fold": 169, "Mark1": 3.9, "Mark2": 8.6}, {"Fold": 170, "Mark1": 3.9, "Mark2": 8.5}, {"Fold": 171, "Mark1": 4.0, "Mark2": 8.4}, {"Fold": 172, "Mark1": 4.1, "Mark2": 8.3}, {"Fold": 173, "Mark1": 4.2, "Mark2": 8.1}, {"Fold": 174, "Mark1": 4.3, "Mark2": 8.0}, {"Fold": 175, "Mark1": 4.4, "Mark2": 7.8}, {"Fold": 176, "Mark1": 4.6, "Mark2": 7.6}, {"Fold": 177, "Mark1": 4.7, "Mark2": 7.4}, {"Fold": 178, "Mark1": 4.9, "Mark2": 7.2}, {"Fold": 179, "Mark1": 5.1, "Mark2": 6.9}, {"Fold": 180, "Mark1": 5.6, "Mark2": 6.4}];

function clampInt(v) {
  const n = parseInt(String(v).trim(), 10);
  return Number.isFinite(n) ? n : null;
}

function makeOdd(n) {
  if (n % 2 === 0) return n + 1;
  return n;
}

function computeStartPage(bookPages, pagesNeeded, align) {
  if (!bookPages || bookPages < pagesNeeded) {
    return 1;
  }
  const extra = bookPages - pagesNeeded;

  if (align === "top") return 1;
  if (align === "bottom") {
    let start = extra + 1;
    start = makeOdd(start);
    if (start + pagesNeeded - 1 > bookPages) start -= 2;
    return Math.max(1, start);
  }

  let start = Math.floor(extra / 2) + 1;
  start = makeOdd(start);
  if (start + pagesNeeded - 1 > bookPages) start -= 2;
  return Math.max(1, start);
}

function renderTable(startPageOdd) {
  const tbody = document.querySelector("#tbl tbody");
  tbody.innerHTML = "";
  for (const row of foldsData) {
    const fold = row.Fold;
    const page = startPageOdd + (fold - 1) * 2;
    const tr = document.createElement("tr");

    const tdFold = document.createElement("td");
    tdFold.className = "mono";
    tdFold.textContent = fold;

    const tdPage = document.createElement("td");
    tdPage.className = "mono";
    tdPage.textContent = page;

    const tdM1 = document.createElement("td");
    tdM1.className = "mono";
    tdM1.textContent = row.Mark1;

    const tdM2 = document.createElement("td");
    tdM2.className = "mono";
    tdM2.textContent = row.Mark2;

    tr.append(tdFold, tdPage, tdM1, tdM2);
    tbody.appendChild(tr);
  }
}

function updateKPIs(startPageOdd, bookPages, pagesNeeded) {
  document.getElementById("kpiStart").textContent = startPageOdd ? startPageOdd : "—";
  const endPage = startPageOdd ? (startPageOdd + pagesNeeded - 1) : null;
  document.getElementById("kpiEnd").textContent = endPage ? endPage : "—";

  const status = document.getElementById("status");
  if (bookPages && bookPages >= pagesNeeded) {
    status.textContent = "Loaded: " + foldsData.length + " folds • Centered within your book (" + bookPages + " pages)";
  } else if (bookPages) {
    status.textContent = "Loaded: " + foldsData.length + " folds • Your book looks too small (" + bookPages + " pages). Showing default start.";
  } else {
    status.textContent = "Loaded: " + foldsData.length + " folds • Default start page (1)";
  }
}

function apply() {
  const bookPages = clampInt(document.getElementById("bookPages").value);
  const align = document.getElementById("align").value;
  const pagesNeeded = 362;

  const start = computeStartPage(bookPages, pagesNeeded, align);
  renderTable(start);
  updateKPIs(start, bookPages, pagesNeeded);
}

document.getElementById("btnApply").addEventListener("click", apply);
document.getElementById("btnReset").addEventListener("click", () => {
  document.getElementById("bookPages").value = "";
  document.getElementById("align").value = "center";
  apply();
});

document.getElementById("btnPrint").addEventListener("click", () => window.print());

document.getElementById("btnDownload").addEventListener("click", () => {
  const bookPages = clampInt(document.getElementById("bookPages").value);
  const align = document.getElementById("align").value;
  const pagesNeeded = 362;
  const start = computeStartPage(bookPages, pagesNeeded, align);

  const header = ["Fold","Page","Mark1","Mark2"];
  const lines = [header.join(",")];

  for (const row of foldsData) {
    const fold = row.Fold;
    const page = start + (fold - 1) * 2;
    lines.push([fold, page, row.Mark1, row.Mark2].join(","));
  }

  const blob = new Blob([lines.join("\n")], {type:"text/csv;charset=utf-8"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = patternName + "_19cm_table.csv";
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
});

apply();
</script>
</body>
</html>
